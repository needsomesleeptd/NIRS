\usepackage{multirow}
\chapter{Аналитический раздел}

\section{Структура PDF файла}
\subsection{Представление PDF файла}
PDF документ имеет иерархическую структуру (дерево), корнем которого является словарь
Catalog. Визуализацию данного дерева можно рассмотреть на рисунке \ref{img:PDF-document-structure}.


\includeimage
{PDF-document-structure} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
{f} % Обтекание (без обтекания)
{H} % Положение рисунка (см. figure из пакета float)
{0.9\textwidth} % Ширина рисунка
{Пример дерева PDF документа} % Подпись рисунка

Каталог содержит ссылки на вершины описания страниц. Поддеревья страниц отсортированны, что позволяет быстро находить необходимую страницу.
Словарь каждой страницы хранит ссылку на словарь ресурсов, который хранит требуемые шрифты, изображения т.~д. \cite{pdf_object_def}.



\subsection{Разделы PDF файла}
Структура PDF файла включает 4 раздела:
\begin{enumerate}
	\item заголовок;
	\item тело;
	\item таблица перекрестных ссылок;
	\item хвост \cite{pdf_object_def}.
\end{enumerate}
Рассмотрим каждый раздел по отдельности.
\subsubsection{Заголовок}
Заголовком называется первая строка файла. Она содержит информацию о версии PDF \cite{pdf_object_def}. Пример заголовка выглядит как \texttt{\%PDF-1.5}.


\subsubsection{Тело}
Все содержимое документа находится в теле файла. Информация, которая отображается пользователю представлена восемью типами данных:
\begin{enumerate}
	\item булевы значения. Принимают значения true или false);
	\item числа. Включают два типа данных — integer (целочисленный) и real (вещественный). Дробная часть в вещественных числах отделяется точкой;
	\item имена. Представляют собой последовательность ASCII символов. Они начинаются со слеша, который не входит в имя. Вместо непосредственно символов могут включать их шестнадцатеричные коды, начинающиеся с символа \#;
	\item строки. Ограничены длиной в 65535 байтов. Записываются в круглых либо треугольных скобках. Могут быть представлены как ASCII символами, так и шестнадцатеричными или восьмеричными кодами.
	\item массивы. Могут содержать любые PDF-объекты. Элементы разделяются пробелом и заключаются в квадратные скобки;
	\item словари. Представляют коллекцию пар ключ-значение. Ключом должно быть имя, а значением может быть любой объект. Запись словаря начинается с символов «, а заканчиваются — »;
	\item потоки. Потоки содержат неограниченные последовательности байтов. В них содержится основное содержимое документов. Поток начинается с ключевого слова \texttt{stream} и заканчивается словом \texttt{endstream}. Перед началом потока записывается словарь с мета-информацией. Он включает данные о количестве байтов, фильтре применимом их к обработке и так далее;
	\item null-объекты. Представляются ключевым словом \texttt{null} \cite{pdf_object_def}.
\end{enumerate}
\textbf{PDF объектом} является любой вышеперечисленный тип, содержащий информацию \cite{pdf_object_def}.
Пример <<хвоста>> PDF файла приведен в листинге \ref{lst:body}.


\subsubsection{Хвост}
Данный раздел начинается с ключевого слова \texttt{trailer} и содержит:
\begin{enumerate}
	\item словарь;
	\item смещение относительно таблицы  перекрестных ссылок (англ. cross-reference table);
	\item маркер конца файла \texttt{\%\%EOF}.
\end{enumerate}
В словарь данного раздела входят:
\begin{enumerate}
	\item Данные о количестве объектов (ключевое слово \texttt{Size});
	\item ссылки на каталог документа (ключевое слово \texttt{Root});
	\item информационный словарь (ключевое слово \texttt{Info});
	\item идентификатор файла (ключевое слово \texttt{ID}) \cite{pdf_object_def}.
\end{enumerate}
Пример <<хвоста>> PDF файла приведен в листинге \ref{lst:tail}.






\subsubsection{Таблица  перекрестных ссылок}
Cross-reference table позволяет получать произвольный доступ к любому объекту в файле. Данная таблица состоит из секций. Каждая секция соответствует  новой версии документа, данная таблица начинается с ключевого слова \texttt{xref}, так что иногда ее называют xref таблицей \cite{pdf_structure_trans}.

\begin{lstlisting}[label=lst:xref,caption=Пример таблицы перекрестных ссылок]
xref
	0 44
	0000000000 65535 f 
	0000000361 00000 n 
	0000000257 00000 n 
	0000000015 00000 n 
\end{lstlisting}






Любой PDF-объект может быть помечен уникальным идентификатором и использоваться как ссылка. Такие объекты называются косвенными. Они начинаются с идентификатора, номера поколения и ключевого слова \texttt{obj}. Заканчивается косвенный объект словом \texttt{endobj}. На эти объекты можно ссылаться в таблице 
cross-reference table и любом другом объекте (для этого используется символ R) \cite{pdf_structure_trans}. 


\section{Виды PDF форматов}
В данной части работы будут проанализированы существующие виды PDF документов.
Существует несколько различных видов PDF документов, каждый из которых имеет свои особенности и ограничения:
\begin{enumerate}
	\item PDF/A;
	\item PDF/X;
	\item PDF/E;
	\item PDF/UA.
\end{enumerate}
Рассмотрим каждый из них по отдельности.
\subsection{PDF/A}



Данный формат, предназначенный для долгосрочного хранения документов. Он обеспечивает сохранность и неприкосновенность содержимого даже через длительные периоды времени. Однако, PDF/A ограничен в функциональности и не поддерживает некоторые расширенные возможности форматов PDF \cite{pdf_levels_std}.
Данный формат также разделяется на несколько подклассов: PDF/A-1, PDF/A-2, PDF/A-3, PDF/A-4.


Также вводится новое понятие уровня соответствия, оно накладывает дополнительные требования на классы PDF/A, для предоставления дополнительных возможностей.
Расссмотрим уровни соответствия.
\begin{enumerate}
	\item Уровень b (Basic).
	Цель: обеспечение надёжного воспроизведения внешнего вида документа.
	Распространяется на файлы формата: PDF/A-1b, PDF/A-2b, PDF/A-3b;
	\item уровень a (Accessible).
	Цель: обеспечение возможности поиска и преобразования содержимого документа.
	Включает все требования уровня b и дополнительно требует, чтобы была включена структура документа.
	Также вводит требования:
	\begin{enumerate}
		\item Содержимое должно быть помечено деревом иерархической структуры, что означает, что такие элементы, как порядок чтения, рисунки и таблицы, явно идентифицируются с помощью метаданных.
		\item Должен быть указан естественный язык документа.
		\item Изображения и символы должны иметь альтернативный описательный текст.
		Файл должен включать сопоставление символов с Unicode.
	\end{enumerate}
	Распространяется на файлы формата: PDF/A-1a, PDF/A-2a, PDF/A-3a;
	
	\item уровень u (Unicode).
	Распространяется на файлы формата: PDF/A-2u, PDF/A-3u.
	Требуется сопоставление символов с Unicode.
	Изменения:
	отбрасываются требования уровня a, включая встроенную логическую структуру (т. е. теги и дерево структур);
	
	\item уровень f (Format).
	Распространяется на файлы формата: PDF/A-4f.
	Изменения:
	позволяет встраивать типы файлов любого другого формата;
	
	\item уровень e (Engineering).
	Распространяется на файлы формата: PDF/A-4e.
	Изменения:
	поддержка аннотаций типов RichMedia и 3D \cite{pdf_levels_std}.
\end{enumerate}


\subsubsection{PDF/A-1}
PDF/A-1 - самый распространенный формат оригинального PDF/A на сегодняшний день. Он основан на PDF 1.4 и является наиболее ограниченным, так как не поддерживает JPEG 2000, вложения, слои и прозрачность. Часть 1 стандарта была опубликована 28 сентября 2005 года и определяет два уровня соответствия для файлов PDF: PDF/A-1b и PDF/A-1b \cite{pdf_a_2}.


\subsubsection{PDF/A-2}
PDF/A-2 предоставляет собой ряд новых функций:
\begin{enumerate}
\item сжатие JPEG2000, что особенно полезно для отсканированных документов, таких как карты, книги, а также документов с цветным содержимым, таких как чеки или паспорта;
\item вложенные файлы PDF/A через коллекции: Acrobat позволяет пользователям создавать коллекции (иногда также называемые "портфелями"), где несколько документов PDF/A объединяются в один "контейнерный" документ PDF;

\item необязательное содержимое (слои): Необязательное содержимое, иногда также называемое слоями, полезно для приложений картографии или инженерных чертежей, где отдельные слои могут быть показаны или скрыты в соответствии с требованиями просмотра;
\item новый уровень соответствия PDF/A-2u - "u" для Unicode. Он упрощает поиск и копирование текста Unicode для цифровых PDF-документов и PDF-документов, которые были отсканированы с последующим оптическим распознаванием символов (OCR);

\item метаданные на уровне объекта XMP: PDF/A-2 определяет требования к настраиваемым метаданным XMP;

\item цифровые подписи: В то время как PDF/A-1 уже позволяет использовать цифровые подписи, PDF/A-2 определяет правила, которые должны быть применены для гарантии взаимодействия \cite{pdf_a_2}.
\end{enumerate}
\subsubsection{PDF/A-3}
PDF/A-3 полностью аналогичен PDF/A-2, однако поддерживает добавление любых файлов, а не только PDF типа A. Однако не гарантирует валидность их прочтения в будущем \cite{pdf_a_2}.

Также стоит отметить, что файлы данного вида возможно использовать в электронном документообороте \cite{nalogi}.
\subsubsection{PDF/A-4}
Основное отличие данного вида, является замена уровней соответствия b и u с целью упростить стандарт. PDF/A-4 требует отображения в Юникоде для всех шрифтов в любое время \cite{pdf_a_4}.

\subsection{PDF/X}
Формат, разработанный специально для обмена и печати документов в издательской отрасли. Он обеспечивает точность цветов и расположения элементов страницы, что особенно важно при печати. Однако, PDF/X имеет ограниченные возможности вставки мультимедийных элементов и интерактивности \cite{abdobe_PDF}.


\subsection{PDF/E}
Формат, предназначенный для обмена и хранения документов в инженерной отрасли. Он поддерживает вставку трехмерных моделей, векторных изображений и других инженерных элементов. Однако, PDF/E может быть ограничен в возможности обработки сложных макетов и мультимедийных элементов \cite{abdobe_PDF}.
\subsection{PDF/UA}
Формат, предназначенный для создания доступных документов для пользователей с ограниченными возможностями. Он обеспечивает структурированное представление контента и поддержку технологий чтения вслух и управления навигацией. Однако, PDF/UA может иметь ограничения в отображении сложных макетов и интерактивных элементов \cite{abdobe_PDF}.






\section{Основные ошибки в отчетах}
В данном разделе будут рассмотрены наиболее часто встречающиеся ошибки, которые совершают студенты при написании различных отчетов.

\subsection{Общие ошибки}
Выход за границы листа является одной из самых распространенных ошибок. В ГОСТ 7.32 указаны следующие размеры полей: левое — 30 мм, правое — 15 мм, верхнее и нижнее — 20 мм \cite{GOST732}.

Каждый объект (например: таблица, рисунок, схема алгоритма, формула) должен быть подписан и пронумерован, однако более подробно подписи к каждому из них будут рассмотрены в следующих разделах.

Если таблица или схема не влезает на одну страницу, то она разбивается на несколько частей, каждая из них должна быть подписана.

\subsection{Ошибки в тексте}
В предыдущем разделе уже были рассмотрены поля документа, однако во время оформления текста отчетов могут возникнуть и другие ошибки.

Ненумерованный заголовок (введение, список литературы, оглавление и т.п.) должен быть выравнен по центру, при этом он состоит только из прописных букв.

Абзацный отступ должен быть одинаковым по всему тексту отчета и равен 1,25 см \cite{GOST732}.

Возможна потеря научного стиля и переход к публицистике, что является ошибкой. Также текст работы должен быть написан на государственном языке.

\subsection{Ошибки в рисунках}
Каждый рисунок должен быть подписан, при этом подпись должна располагаться строго по центру, внизу рисунка.

Все рисунки должны быть выполнены в высоком качестве, если обратное не требуется в самой работе.

Если рисунок не вмещается в ширину страницы, то допускается повернуть его таким образом, чтобы верх рисунка был ближе к левой части страницы.

\subsubsection{Ошибки в графиках}
Для каждого графика должна существовать легенда, для оформления которой есть два варианта:
\begin{enumerate}
	\item в одном из углов графика находится область, в которой указаны все обозначения;
	\item в подписи к графику описано каждое обозначение.
\end{enumerate}

Должны быть подписаны единицы измерения каждой из осей (даже в том случае, если на гистограмме оси подписываются словами, например, если измерение идет в штуках или на оси обозначены времена года).

Отчеты могут быть напечатаны в черно-белом варианте, поэтому на графиках должны быть маркеры, которые позволят отличить графики друг от друга даже не в цветом варианте.

При большом количестве графиков на одном рисунке возможна ситуация, при которой невозможно отличить один график от другого, что является ошибкой.

\subsubsection{Ошибки в схемах алгоритмов}
Если схема не влезает на одну страницу, то она разбивается на несколько частей, каждая из них должна быть подписана. Для разделения схемы алгоритма на части используется специальный символ-соединитель, который отображает выход в часть схемы и вход из другой части этой схемы, соответствующие символы-соединители должны содержать одно и то же уникальное обозначение.

Довольно часто вместо символа начала или конца алгоритма используют овал, однако в этом случае должен быть использован прямоугольник с закругленными углами.

Также при использовании символа процесса (прямоугольник) используют прямоугольник с закругленными углами.

При соединении символов схемы алгоритмов не нужны стрелки, если они соединяют символы в направлении слево-направо или сверху-вниз, в остальных случаях символы должны соединяться линиями со стрелкой на конце.

При использовании символа процесса---решение как минимум одна из соединительных линий должна быть подписана, однако возможен также вариант, когда подписаны обе линии.

Пояснительный текст не должен пересекаться с символами, использующимися для составления схем.

\subsection{Ошибки в таблицах}
Каждая таблица должна быть подписана. Наименование следует помещать над таблицей слева, без абзацного отступа в следующем формате: Таблица Номер таблицы - Наименование таблицы. Наименование таблицы приводят с прописной буквы без точки в конце\cite{GOST732}.

Таблицу с большим количеством строк допускается переносить на другую страницу. При переносе части таблицы на другую страницу слово «Таблица», ее номер и наименование указывают один раз слева над первой частью таблицы, а над другими частями также слева пишут слова «Продолжение таблицы» и указывают номер таблицы\cite{GOST732}.

\subsection{Ошибки в формулах}
Каждая формула должна быть пронумерована вне зависимости от того, есть ли на нее ссылка в тексте или нет. Нумерация может осуществляться в двух вариантах:
\begin{enumerate}
	\item сквозная нумерация (номер формулы не зависит от раздела, в котором она находится);
	\item нумерация, зависящая от раздела (в том случае номер формулы начинается с номера раздела).
\end{enumerate}

После каждой формулы должен находиться знак препинания (точка, запятая и т.п.).

Если в формуле содержится система уравнений, то после каждого из них (за исключением последнего) ставится запятая, а после последнего --- точка, либо запятая.

Номер формулы должен быть выравнен по правому краю страницы и находиться по центру формулы.

Если формула вставляется в начале страницы, то часто перед ней может присутствовать отступ, которого быть не должно.

\subsection{Ошибки в списках}
Ненумерованные списки должны начинаться с удлиненного тире.

В нумерованных списках после номера пункта обязательно должна стоять скобка.

В конце каждого пункта списка должен быть знак препинания, от которого зависит первая буква первого слова следующего пункта:
\begin{itemize}
	\item если пункт заканчивается на точку, то первое слово следующего пункта должно начинаться на прописную букву;
	\item если пункт заканчивается запятой или точкой с запятой, то следующий первое слово следующего слово должно начинаться со строчной буквы.
\end{itemize}

\subsection{Ошибки в списке литературы}
Часто при описании одного из источников не указывается одна из составных частей (автор, издательство и т.п.).

Также нередко встречаются ссылки на так называемые «препринтовские» издательства (сама статья еще не вышла).

\includeimage
{chapterNameMist} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
{f} % Обтекание (без обтекания)
{h} % Положение рисунка (см. figure из пакета float)
{1\textwidth} % Ширина рисунка
{Пример ошибочного оформления ненумерованного заголовка} % Подпись рисунка

\includeimage
{imgRotateMist} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
{f} % Обтекание (без обтекания)
{h} % Положение рисунка (см. figure из пакета float)
{1\textwidth} % Ширина рисунка
{Пример ошибочного оформления рисунка --- некорректный поворот} % Подпись рисунка

\includeimage
{graphAxesMist} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
{f} % Обтекание (без обтекания)
{h} % Положение рисунка (см. figure из пакета float)
{1\textwidth} % Ширина рисунка
{Пример ошибочного оформления графика --- отсутствуют единицы измерения} % Подпись рисунка

\includeimage
{schemeStartMist} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
{f} % Обтекание (без обтекания)
{h} % Положение рисунка (см. figure из пакета float)
{0.5\textwidth} % Ширина рисунка
{Пример ошибочного оформления схемы --- некорректный символ начала} % Подпись рисунка

\includeimage
{schemeRectMist} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
{f} % Обтекание (без обтекания)
{h} % Положение рисунка (см. figure из пакета float)
{0.5\textwidth} % Ширина рисунка
{Пример ошибочного оформления схемы --- некорректный символ процесса} % Подпись рисунка

\includeimage
{schemeDecMist} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
{f} % Обтекание (без обтекания)
{h} % Положение рисунка (см. figure из пакета float)
{0.7\textwidth} % Ширина рисунка
{Пример ошибочного оформления схемы --- не подписана ни одна из веток символа процесса---решение} % Подпись рисунка

\includeimage
{eqSystemMist} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
{f} % Обтекание (без обтекания)
{h} % Положение рисунка (см. figure из пакета float)
{1\textwidth} % Ширина рисунка
{Пример ошибочного оформления системы уравнений --- отсутствуют знаки препинания после уравнений} % Подпись рисунка

\includeimage
{itemizeMist} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
{f} % Обтекание (без обтекания)
{h} % Положение рисунка (см. figure из пакета float)
{1\textwidth} % Ширина рисунка
{Пример ошибочного оформления ненумерованного списка --- некорректный символ перед элементами списка} % Подпись рисунка

\includeimage
{itemizeLettersMist} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
{f} % Обтекание (без обтекания)
{h} % Положение рисунка (см. figure из пакета float)
{1\textwidth} % Ширина рисунка
{Пример ошибочного оформления ненумерованного списка --- некорректный регистр буквы следующего пункта после запятой в предыдущем} % Подпись рисунка

\includeimage
{enumerateMist} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
{f} % Обтекание (без обтекания)
{h} % Положение рисунка (см. figure из пакета float)
{1\textwidth} % Ширина рисунка
{Пример ошибочного оформления нумерованного списка --- некорректный символ после номера элемента списка} % Подпись рисунка

\section{Библиотеки по работе с PDF-файлами}
В данной части работы будут сравниваться существующие Python-библиотеки для извлечения данных из PDF-файлов, охватывая из возможности с точки зрения извлечения текста, изображений и таблиц, скорости выполнения и обширности функциональности.
\subsection{PyPDF2}
PyPDF2 - это библиотека на чистом Python, которая позволяет читать PDF-файлы и манипулировать ими. Хотя она в основном ориентирована на извлечение текста, она также предоставляет ограниченную поддержку для извлечения изображений. Однако извлечение таблиц не является встроенной функцией. PyPDF2 получил широкое распространение благодаря небольшой, но достаточной, функциональности и обширной документации.
\subsection{pdfminer.six}
pdfminer.six - это поддерживаемая сообществом библиотека Python, основанная на оригинальном проекте PDFMiner. Она предлагает расширенные возможности для извлечения текста из PDF-файлов, включая возможность извлекать информацию о макете текста. Однако она не обеспечивает прямой поддержки извлечения изображений или таблиц. pdfminer.six известен своей точностью при извлечении текста, так как была специально разработана для его извлечения из PDF-файлов.
\subsection{PyMuPDF}
PyMuPDF - это привязка Python для библиотеки MuPDF, которая известна своими высокопроизводительными возможностями рендеринга и синтаксического анализа. PyMuPDF предлагает обширные возможности для извлечения как текста, так и изображений из PDF-файлов. Хотя он не обеспечивает встроенного извлечения таблиц, он обеспечивает прочную основу для реализации пользовательских алгоритмов извлечения таблиц. PyMuPDF полностью документирован и предоставляет богатый набор функциональных возможностей.

\begin{tabular}{ |p{3cm}||p{3cm}|p{3cm}|p{3cm}|  }
	\hline
	Функциональность \multicolumn{3}{|c|}{Библиотеки} \\
	\hline
	& PyPDF2 & pdfminer.six & PyMuPDF \\
	\hline
	Извлечение таблиц & Нет встроенной поддержки & Нет встроенной поддержки & Требуется пользовательская реализация, но имеются необходимые инструменты для ее создания \\
	\hline
	Извлечение текста & Поддерживает & Поддерживает & Поддерживает \\
	\hilne
	Извлечение изображений & Ограниченная поддержка & Ограниченная поддержка & Поддерживает \\
	\hline

